<?xml version="1.0" encoding="UTF-8"?>

<beans
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns="http://www.springframework.org/schema/beans"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:util="http://www.springframework.org/schema/util"
	xmlns:property="http://www.springframework.org/schema/p"
	xmlns:transaction="http://www.springframework.org/schema/tx"
	xmlns:context="http://www.springframework.org/schema/context"

	xsi:schemaLocation="
			http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
			http://www.springframework.org/schema/aop
            http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
            http://www.springframework.org/schema/util
            http://www.springframework.org/schema/util/spring-util.xsd
            http://www.springframework.org/schema/context
            http://www.springframework.org/schema/context/spring-context-3.0.xsd">
	
	<description>TODO</description>
	
	<context:property-placeholder
		location="classpath:*/**/spring.properties" 
		properties-ref="ikube.toolkit.PropertyConfigurer" />
	
	<bean 
		id="ikube.toolkit.Logging" 
		class="org.springframework.beans.factory.config.MethodInvokingFactoryBean"
		property:staticMethod="ikube.toolkit.Logging.configure" />

	<!-- This bean will look through the classpath and load every Spring properties file it finds. -->
	<bean
		id="ikube.toolkit.PropertyConfigurer"
		class="ikube.toolkit.PropertyConfigurer"
		property:fileNamePattern="spring.properties"
		lazy-init="false"
		init-method="initialize" />
	
	<!-- Turn on AspectJ @Configurable support -->
	<context:spring-configured />
	<context:component-scan base-package="ikube" />
	
	<import resource="**/spring-*.xml" />
	
	<bean 
		class="ikube.deploy.Deployer"
		property:parallel="true"
		property:maxWaitTime="600"
		property:servers-ref="servers" />
	
	<util:list id="servers">
		<ref bean="ikube.action.Close"  />
	</util:list>
	
	<bean 
		id="server-one"
		name="server-one"
		class="ikube.deploy.model.Server"
		property:ip="192.168.1.200"
		property:username="michael"
		property:password="Bp0st2013"
		property:actions-ref="actions" />
	
	<util:list id="actions">
		<ref local="stopAction" />
		<ref local="copyAction" />
		<ref local="startAction" />
	</util:list>
	
	<bean 
		id="stopAction"
		name="stopAction"
		class="ikube.deploy.action.CommandAction"
		property:commands-ref="stopCommands" />
	<util:list id="stopCommands">
		<bean 
			class="ikube.deploy.model.Command"
			property:command=". /etc/profile;" />
	</util:list>
	
	<bean 
		id="copyAction"
		name="copyAction"
		class="ikube.deploy.action.CopyAction"
		property:files-ref="files"
		property:directories-ref="directories" />
	
	<util:map id="files">
		<entry>
			<key></key>
			<value></value>
		</entry>
	</util:map>
	
	<util:map id="directories">
		<entry>
			<key></key>
			<value></value>
		</entry>
	</util:map>
	
	<bean 
		id="startAction"
		name="startAction"
		class="ikube.deploy.action.CommandAction"
		property:commands-ref="startCommands" />
	<util:list id="startCommands">
		<bean 
			class="ikube.deploy.model.Command"
			property:command=". /etc/profile;" />
	</util:list>
	
</beans>